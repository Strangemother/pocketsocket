{"name":"Pocketsocket","tagline":"Plug and play Python / Javascript websockets","body":"# Pocketsocket\r\n\r\nA fast all round solution to websockets using python and javascript.\r\n\r\n*python*\r\n    \r\n    $ virtualenv env\r\n    $ pip install docopts\r\n    $ python server.py -ev\r\n\r\n\r\n*javascript*\r\n\r\n    pocket.socket.setup('127.0.0.1:8001').on('socket', function (name){\r\n            console.log(\"socket\", name);\r\n        }).connect();\r\n\r\n\r\n**web sockets are done!**\r\n\r\n\r\nIn this library, you'll find a nice basic javascript API for handling and creating channels and extendable server based on http://opiate.github.io/SimpleWebSocketServer.\r\n\r\nYou could role out your own websocket solution, but consider using a pocketsocket to get you started on your realtime massive project.\r\n\r\n## Features\r\n\r\n* Connect to many websockets at once and send to all simultaneously (broadcast)\r\n* Auto reconnect feature for lost websocket connection.\r\n* Light channel based client communication\r\n* Auto json\r\n* use sockets with a familiar and simple API:\r\n    \r\n    *  `setup(*addressConfig*)`            - setup your websocket connection\r\n    *  `connect()`                         - start socketing...\r\n    *  `on('channel', 'event', function)`  - listen to your signals\r\n    *  `signal('channel', 'event', data)`  - send a signal\r\n\r\n### Extending features.\r\n\r\n* Communicate without channels easily.\r\n* Clever url parsing at setup (makes it easier to integrate)\r\n* automatic socket communication for core message\r\n\r\n----\r\n\r\n# TL;DR:\r\n\r\nA quick list of the main features of pocketsocket.\r\n\r\n\r\n### setup()\r\n\r\nIntialize the library with socket setup to IPs and ports\r\n\r\n\r\n    pocket.socket.setup('127.0.0.1:8001');\r\n    \r\n    pocket.socket.setup('127.0.0.1', 8001);\r\n\r\n    var addresses = ['192.168.0.55', '127.0.0.1'];\r\n    var ports     = [8001, 8009];\r\n    pocket.socket.setup(addresses, ports, 'broadcast');\r\n\r\n    var addressPair = {\r\n        'local': ['120.0.0.1', 8001],\r\n        'dev': ['192.168.0.55', 8009]\r\n    };\r\n    pocket.socket.setup(addressPair)\r\n\r\n\r\n### connect()\r\n\r\nPerform the connection routine\r\n\r\n    // no parameters after .setup() called\r\n    pocket.socket.connect()\r\n    \r\n    // With url list\r\n    pocket.socket.connect(['127.0.0.1:8001'])\r\n\r\n\r\n### on()\r\n\r\nsetup an event listener\r\n\r\n    pocket.socket.on('fooChannel', function(name, data) {\r\n        switch(name) {\r\n            case 'connecting':\r\n                console.log(\"connecting\", data[1]);\r\n                break;\r\n            case 'open':\r\n                console.log(\"open\", data.socket.uri)\r\n        }\r\n         console.log(\"data replied: \", name, data)\r\n    })\r\n\r\n\r\n    pocket.socket.on('fooChannel', 'barEvent', function(e, socket){\r\n        console.log(\"fooChannel has barEvent\", socket)\r\n    });\r\n\r\n\r\n### signal()\r\n\r\nDispatch a message through the channel framework\r\n\r\n    // Dispatch an empty signal\r\n    pocket.socket.signal('fooChannel', 'barEvent')\r\n    \r\n    // Dispatch with some json data\r\n    pocket.socket.signal('fooChannel', 'barEvent', {})\r\n\r\n    // pass an event AugmentedWebSocket (overrides a broadcast setup)\r\n    pocket.socket.signal('fooChannel', 'barEvent', {}, socket)\r\n\r\n----\r\n\r\n# Getting Started.\r\n\r\nFirst get the server running on your server. To get it going, not to much is needed.\r\n\r\n### Requirements\r\n\r\n    docopts\r\n    * opaite/SimpleWebSocketServer      supplied\r\n    * strangemother/poo                 supplied\r\n    * strangemother/django-djansoner    supplied\r\n\r\n\r\n#### Installing requirements\r\n    \r\n    $ virtualenv env\r\n    $ pip install docopts\r\n\r\n\r\n----\r\n\r\n## Running server.py\r\n\r\n\r\nYour websocket server has a few options\r\n\r\n    --verbose    prints data when supplied from a socket\r\n    --echo       return message to sender as echo response\r\n\r\n\r\nWe'll use these options because it's easier to see whats happening to our messages!\r\n\r\nYou can also specify an IP address and port. By default they are `127.0.0.1` and `8001` respectively. You can pass these into the command line.\r\n\r\n    // example map to external listening IP\r\n    $ python server.py 0.0.0.0 8001\r\n\r\n\r\n*Run this one* In our example, it's best to run simple like this. The server will tell you it's ready.\r\n\r\n    $ python server.py -ev\r\n\r\nIt'll return something like `Ready 127.0.0.1 8001`. All information proceeding will be communications sent and received.\r\n\r\n----\r\n\r\n## Running pocket.socket javascript\r\n\r\nNow your server is running, we can take a look at how to send information to it. \r\n\r\nFirst we need to give pocket.socket connection information. This can range from a single string to a large array of possible connections.\r\n\r\n\r\n### Setting up connections\r\n\r\nLets have a look at the `.setup()` method\r\n\r\n\r\n#### Basic Setup\r\n\r\npass a single string to the setup method. You can combine your ip and port into a single connection address.\r\n\r\n    pocket.socket.setup('127.0.0.1:8001');\r\n\r\n\r\n#### Pair Setup\r\n\r\nAlternatively, you can supply the IP and port individually. \r\n\r\n    pocket.socket.setup('127.0.0.1', 8001);\r\n\r\n\r\n#### Duplex Setup\r\n\r\nYou can now do something very advanced - connect to many concurrent websocket connections and broadcast a message across all.\r\n\r\nThis will allow you to host lots of server's on many different IP addresses. \r\nIn the example below, we have a local IP and a dev machine; both listening to the same event. Both will send and receive the same information.\r\n\r\n    var addresses = ['192.168.0.55', '127.0.0.1'];\r\n    var ports     = [8001, 8009];\r\n\r\n    pocket.socket.setup(addresses, ports, 'broadcast');\r\n\r\n\r\n*Something interesting*\r\n\r\nDuplicating addresses can do more and enumerate a flat pair. You can specify a `mix` or `flat` enumeration.\r\n\r\nThe following methods will provide a list of socket address enumerated based upon `mix` of `flat`.\r\n\r\n    pocket.socket.connection.list('mix');\r\n    pocket.socket.connection.list('flat');\r\n\r\n\r\nTo make it easier to ead these back, You have some helper functions:\r\n    \r\n    // Provides an array of socket string uri's\r\n    socket.socket.connection.list('flat').toArray();\r\n\r\n    // Provides a comma delimited string of socket connection uri's\r\n    socket.socket.connection.list('flat').toString();\r\n\r\n\r\n#### Dictionary (object) Setup\r\n\r\nYou can also supply an object to setup, with array's of IP, port pairs. The key names are ignored within `pocket.socket`.\r\n\r\n    var addressPair = {\r\n        'local': ['120.0.0.1', 8001],\r\n        'dev': ['192.168.0.55', 8009]\r\n    };\r\n    pocket.socket.setup(addressPair)\r\n\r\n\r\n### Mix Enumeration\r\n\r\nReceive a list of all possible cominations for all ports and IP's passed to the setup method. In the above example you would receive a list of 12 possible connection to use.\r\n\r\n    var addresses = ['192.168.0.55', '127.0.0.1', '44.343.134.135'];\r\n    var ports     = [8001, 8002, 8009, 8010];\r\n\r\n    pocket.socket.setup(addresses, ports, 'broadcast');\r\n    \r\n    pocket.socket.connection.list('mix');\r\n\r\n    [\r\n     \"192.168.0.55:8001\", \r\n     \"192.168.0.55:8002\", \r\n     \"192.168.0.55:8009\", \r\n     \"192.168.0.55:8010\", \r\n     // ... snip ...\r\n     \"44.343.134.135:8009\", \r\n     \"44.343.134.135:8010\"\r\n    ]\r\n\r\n\r\n### Flat Enumeration\r\n\r\nRecieve a list of possible combinations based upon a flat enumeration of IP's ans ports. *You must supply a IP array and a port array of the same length*. \r\n\r\nThe mix enumeration example, 3 addresses are supplied and 4 ports. This will fail in flat enueration.\r\n\r\n    var addresses = ['192.168.0.55', '127.0.0.1'];\r\n    var ports     = [8001, 8009];\r\n\r\n    pocket.socket.setup(addresses, ports, 'broadcast');\r\n    \r\n    pocket.socket.connection.list('flat');\r\n    \r\n    [\r\n     \"192.168.0.55:8001\", \r\n     \"127.0.0.1:8009\"\r\n    ]\r\n\r\n----\r\n\r\n## Connection\r\n\r\nYou can use the `pocket.socket.connection` object to alter the connection list. This is recevied back from the `.setup()` method for lovely chaining.\r\n\r\n    var connection = pocket.socket.setup()\r\n\r\n\r\n### isSetup()\r\n\r\nReturns a boolean value to define if there are addresses to connect to.\r\n    \r\n    pocket.socket.connection.isSetup()\r\n    true/false\r\n\r\n\r\n### list(*'mix' || 'flat'*)\r\n\r\nCall the list method with `mix` or `flat` as the first argument.\r\nreturned is a list of string socket uri's. Read 'Mix Enumeration' and 'Flat Enumeration' for outcome\r\n\r\n    pocket.socket.connection.list('mix');\r\n    pocket.socket.connection.list('flat');\r\n\r\n\r\n### addToList(list, ip, port, name)\r\n\r\nCorrectly implement a new connection to a provided list. This is mainly an internal method and shouldn't be called externally.\r\n\r\n    pocket.socket.connection.addToList()\r\n\r\n\r\n### empty()\r\n\r\ndelete all ips, ports and addresses - this does not disconnect any active connections.\r\n\r\n    pocket.socket.connection.empty()\r\n\r\n----\r\n\r\n## Connect to sockets.\r\n\r\nOkay, you've supplied your list of sockets, you've started your server. Next is to connect.\r\n\r\n    $ pocket.socket.connect()\r\n    $ pocket.socket.setup(addresses, ports).connect()\r\n    $ pocket.socket.connect(pocket.socket.connection.list(), 'broadcast')\r\n\r\n\r\n### makeSocket(url, *[callback]*)\r\n\r\nready up a websocket for connection. pass an optional callback; used for every returned event from the socket.\r\nReturned is a new socket.\r\n\r\n    $ pocket.socket.makeSocket('127..0.0.1:8001', function(name obj){\r\n            // name == open, close, message, error\r\n            // obj == { name, socket, data }\r\n            \r\n        })\r\n\r\n----\r\n\r\n# Sending Messages\r\n\r\nTwo very simple methods have been created for use. The `on()` and `signal()` methods used to send and listen for data.\r\n\r\n## sendToAll(channel, object) \r\n\r\nsend a message to the client on a channel with some data. This is also the `send()` method. This method will continually call the `sendTo()` method\r\n\r\n*send() method is the same*\r\n\r\n\r\n### Simple messaging\r\n\r\nThe channel is in essence the message and is received on the server as `message` You can send any information on the channel. for example:\r\n\r\n    // javascript \r\n    $ pocket.socket.sendToAll('Art can be very abstract.')\r\n\r\nwill successfully send a message to the server and received as something like:\r\n\r\n    // python\r\n    {\"id\":\"0.lchkqdo\",\"message\":\"Art can be very abstract.\",\"data\":{}}\r\n\r\n\r\n### Channel Messaging\r\n\r\nTo utlise the messaging framework and JSONification of your data into a channel, reformat your message to read.\r\n\r\n    // javascript\r\n    $ pocket.socket.sendToAll('socket.message', 'milk');\r\n\r\nOf which appears on the server as:\r\n\r\n    // python\r\n    {\"id\":\"0.12l60m\",\"message\":\"socket.message\",\"data\":\"milk\"}\r\n\r\n\r\n### Channel message JSON\r\n\r\nYou can send a block of data through a channel. by providing an object as the second argument.\r\n\r\n    pocket.socket.sendToAll('socket.message', {\r\n            apples:'green',\r\n            pie: 'cherry',\r\n            animal: 'fishy'\r\n        })\r\n\r\n\r\n## sendTo(AugementedWebSocket, str, val)\r\n\r\nAccepts the same parameters as `sendToAll()` method, but the first argument is a WebSocket element.\r\n\r\n*This is an AugementedWebSocket, of which is a WebSocket but with a couple of extra methods*\r\n\r\n\r\n## signal(channel, eventName, *[data, AugementedWebSocket]*)\r\n\r\nSignal is pushed into the websocket streams. This should be successful for broadcast and overflow. \r\n\r\nprovide a channel name, event name, optionally some data and or a socket.\r\nIf the setup is in broadcast mode for connection type, the forth parameter AugementedWebSocket is ignored as it's not required.\r\n\r\n    pocket.socket.signal('socket' 'message')\r\n\r\nThis is the preferred way to send information through the sockets.\r\n\r\n\r\n## on()\r\n\r\nListening to events is again simple but powerful. There are many ways to setup a listener\r\n\r\n#### Channel Listener\r\n\r\nListen to all events on a single channel. Passed to the the callback function is the name of the event along with the data (socket, event)\r\n\r\n\r\n    pocket.socket.on('socket', function(name, data) {\r\n        switch(name) {\r\n            case 'connecting':\r\n                console.log(\"connecting\", data[1]);\r\n                break;\r\n            case 'open':\r\n                console.log(\"open\", data.socket.uri)\r\n        }\r\n         console.log(\"data replied: \", name, data)\r\n    })\r\n\r\n\r\n#### Event Listener\r\n\r\nYou can listen to a single event on a channel by specifying the event name as the second parameter.\r\n\r\n    pocket.socket.on('socket', 'connected', function(e, socket){\r\n        console.log(\"Socket has connected\", socket)\r\n    });\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}